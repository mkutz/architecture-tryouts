#!/bin/bash

current_branch=$(git symbolic-ref HEAD | sed -e 's,.*/\(.*\),\1,')
protected_branches=( master main )

for protected_branch in "${protected_branches[@]}"; do
  if [[ $protected_branch == "$current_branch" ]]; then
    echo "‚ö†Ô∏è Pushing to protected branch ${current_branch} ‚ö†Ô∏è"
    echo 'Running checks‚Ä¶'

    if [ "$(./gradlew check)" -ne 0 ]; then
      echo '‚Ä¶üí• checks failed. Aborting push.'
      exit 1
    fi
  fi
done

exit 0
